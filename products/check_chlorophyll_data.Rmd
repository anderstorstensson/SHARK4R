---
title: "_check_data: `r params$targetDataset`"
author: "Markus Lindh"
date: '2020-11-07'
output: html_document
params:
  targetDataset: "NAME" # Name of dataset in folder, please write the name exactly as it is in the current source data folder
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Check data

This is an R Markdown document that checks data that has passed initial delivery QC and is now in the test phase.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document.

## Load library and data

```{r loadlibdata, echo=FALSE, include = FALSE}
scriptstart = Sys.time()
library(SHARK4R)
library(tidyverse)
library(DT)
setwd("C:/__R/_test_SHARK4R/")
myfile = shark_read_zip(params$targetDataset)
```

## Check fields

Uses check_fields() function to control if all required fields are present.

```{r checkfields, echo=TRUE}
check_Chlorophyll(myfile)
```

## Overview of data

```{r overview, echo=FALSE}
glimpse(myfile)
DT::datatable(myfile)
```

## Check map

Uses plot_map_leaflet to render an interactive leaflet map of sampled stations in the data.

```{r plotmap, echo=FALSE}
plot_map_leaflet(myfile)
```

## Check station name and geographical bounding box

Uses check_stations() to control if station name is found in the SMHI curated list and location is within preset distance limit

```{r checkstations, echo = TRUE}
# check_stations(myfile)
```

## Check onland

Uses check_onland() to control if any locations are on land.

```{r checkonland, echo = TRUE}
# check_onland(myfile)
```

## Check depth

Uses check_depth() to control if any sample depths are incorrect.

```{r checkdepth, echo = TRUE}
# check_depth(myfile)
```

## Check outliers

Uses check_outliers() function to control if all values are within range.

```{r checkoutliers, echo=TRUE}
check_chlorophyll_conc(myfile)
```

## Check logical

Uses check_logical() function to control if data follows logical assumptions.

```{r checklogical, echo=TRUE}
check_value_logical(myfile)
```

## Check codes

Uses check_codes() function to control if data follows the SMHI codelist.

```{r checkcode, echo=TRUE}
check_code_proj(myfile)
```

## Reproducibility

```{r reproducibility}
# Date time
Sys.time()

# Here we store the session info for this script
sessioninfo::session_info()
```

## Runtime of script

```{r runtime, echo = FALSE}
scriptend = Sys.time()
print(scriptend-scriptstart)
```